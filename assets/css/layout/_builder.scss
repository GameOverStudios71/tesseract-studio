// ==========================================================================
// BUILDER PAGE LAYOUT
// ==========================================================================

@use '../base/variables' as *;
@use '../base/mixins' as *;

// --------------------------------------------------------------------------
// Builder Wrapper
// --------------------------------------------------------------------------
.ts-builder-wrapper {
    display: flex;
    flex-direction: column;
    height: 100vh;
    background: $bg-primary;
    overflow: hidden;
}

// --------------------------------------------------------------------------
// Top Bar
// --------------------------------------------------------------------------
.ts-builder-topbar {
    @include flex-between;
    padding: $spacing-3 $spacing-6;
    background: $bg-secondary;
    border-bottom: 1px solid $border-default;
    flex-shrink: 0;
    z-index: 50;

    @include mobile-only {
        padding: $spacing-3 $spacing-4;
        flex-wrap: wrap;
        gap: $spacing-2;
    }
}

.ts-builder-back-link {
    color: $text-secondary;
    font-size: $font-size-sm;
    @include transition(color);

    &:hover {
        color: $text-primary;
    }
}

.ts-builder-project-info {
    display: flex;
    align-items: center;
    gap: $spacing-2;

    @include mobile-only {
        order: -1;
        width: 100%;
        justify-content: center;
    }

    .project-name {
        font-weight: $font-weight-semibold;
        color: $text-white;
    }

    .project-slug {
        font-size: $font-size-xs;
        font-family: $font-mono;
        color: $text-muted;
    }
}

.ts-builder-actions {
    display: flex;
    gap: $spacing-4;
}

// --------------------------------------------------------------------------
// Flow Container (React Flow)
// --------------------------------------------------------------------------
.ts-flow-container {
    flex: 1;
    width: 100%;
    position: relative;
    overflow: hidden;
    z-index: 1;
}

// --------------------------------------------------------------------------
// React Flow Customizations
// --------------------------------------------------------------------------
.react-flow {
    background: $bg-primary !important;
}

.react-flow__controls {
    background: $bg-secondary;
    border: 1px solid $border-default;
    border-radius: $radius-md;

    button {
        background: $bg-secondary;
        border-bottom: 1px solid $border-default;
        color: $text-primary;

        &:hover {
            background: $bg-tertiary;
        }

        &:last-child {
            border-bottom: none;
        }
    }
}

.react-flow__minimap {
    background: $bg-secondary;
    border: 1px solid $border-default;
    border-radius: $radius-md;
}

// --------------------------------------------------------------------------
// Flow Panel
// --------------------------------------------------------------------------
.ts-flow-panel {
    background: $bg-secondary;
    border: 1px solid $border-default;
    border-radius: $radius-lg;
    padding: $spacing-4;
    color: $text-primary;
    z-index: 10;

    &-header {
        margin-bottom: $spacing-4;

        h2 {
            font-size: $font-size-lg;
            font-weight: $font-weight-bold;
            margin: 0 0 $spacing-1;
        }

        .project-slug {
            font-size: $font-size-xs;
            font-family: $font-mono;
            color: $text-muted;
        }
    }

    &-actions {
        margin-top: $spacing-3;
    }
}

// --------------------------------------------------------------------------
// Flow Info Bar
// --------------------------------------------------------------------------
.ts-flow-info {
    display: flex;
    gap: $spacing-4;
    background: rgba($bg-secondary, 0.9);
    padding: $spacing-2 $spacing-4;
    border-radius: $radius-md;
    font-size: $font-size-xs;
    color: $text-secondary;
    backdrop-filter: blur(8px);
    z-index: 10;
}

// --------------------------------------------------------------------------
// Custom Page Node
// --------------------------------------------------------------------------
.ts-page-node {
    background: $bg-secondary;
    border: 2px solid $accent-blue;
    border-radius: $radius-lg;
    min-width: 180px;
    box-shadow: $shadow-md;
    @include transition(transform, box-shadow, border-color);

    &.selected {
        border-color: $accent-blue-light;
        box-shadow: 0 0 0 3px rgba($accent-blue, 0.3), $shadow-lg;
    }

    &-header {
        display: flex;
        align-items: center;
        gap: $spacing-2;
        padding: $spacing-3 $spacing-4;
        background: linear-gradient(135deg, rgba($accent-blue, 0.3) 0%, transparent 100%);
        border-radius: calc($radius-lg - 2px) calc($radius-lg - 2px) 0 0;
        border-bottom: 1px solid $border-default;
    }

    &-icon {
        font-size: $font-size-lg;
    }

    &-label {
        font-weight: $font-weight-semibold;
        color: $text-white;
        font-size: $font-size-sm;
    }

    &-body {
        padding: $spacing-2 $spacing-4 $spacing-3;
    }

    &-slug {
        font-size: $font-size-xs;
        font-family: $font-mono;
        color: $text-muted;
    }
}